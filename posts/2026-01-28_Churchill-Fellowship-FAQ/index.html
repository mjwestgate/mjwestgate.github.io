<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Martin Westgate">
<meta name="dcterms.date" content="2026-01-27">

<title>Churchill Fellowship FAQ – Martin Westgate</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-fc539113232677d296c547e50173fa21.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Martin Westgate</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-outputs" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Outputs</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-outputs">    
        <li>
    <a class="dropdown-item" href="../../papers.html">
 <span class="dropdown-text">Papers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../packages.html">
 <span class="dropdown-text">Packages</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../presentations.html">
 <span class="dropdown-text">Presentations</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#who-are-you" id="toc-who-are-you" class="nav-link active" data-scroll-target="#who-are-you">Who are you?</a></li>
  <li><a href="#what-is-a-churchill-fellowship" id="toc-what-is-a-churchill-fellowship" class="nav-link" data-scroll-target="#what-is-a-churchill-fellowship">What is a Churchill Fellowship?</a></li>
  <li><a href="#what-problem-are-you-trying-to-solve" id="toc-what-problem-are-you-trying-to-solve" class="nav-link" data-scroll-target="#what-problem-are-you-trying-to-solve">What problem are you trying to solve?</a></li>
  <li><a href="#arent-there-already-tools-to-detect-problematic-occurrences" id="toc-arent-there-already-tools-to-detect-problematic-occurrences" class="nav-link" data-scroll-target="#arent-there-already-tools-to-detect-problematic-occurrences">Aren’t there already tools to detect problematic occurrences?</a></li>
  <li><a href="#why-have-you-chosen-to-explore-statistical-modelling" id="toc-why-have-you-chosen-to-explore-statistical-modelling" class="nav-link" data-scroll-target="#why-have-you-chosen-to-explore-statistical-modelling">Why have you chosen to explore statistical modelling?</a></li>
  <li><a href="#what-will-you-do-during-your-fellowship" id="toc-what-will-you-do-during-your-fellowship" class="nav-link" data-scroll-target="#what-will-you-do-during-your-fellowship">What will you do during your Fellowship?</a></li>
  <li><a href="#what-are-your-questions" id="toc-what-are-your-questions" class="nav-link" data-scroll-target="#what-are-your-questions">What are your questions?</a></li>
  <li><a href="#what-outcomes-are-you-hoping-for" id="toc-what-outcomes-are-you-hoping-for" class="nav-link" data-scroll-target="#what-outcomes-are-you-hoping-for">What outcomes are you hoping for?</a></li>
  <li><a href="#youre-not-visiting-my-institution-city-country---can-i-still-contribute" id="toc-youre-not-visiting-my-institution-city-country---can-i-still-contribute" class="nav-link" data-scroll-target="#youre-not-visiting-my-institution-city-country---can-i-still-contribute">You’re not visiting my institution / city / country - can I still contribute?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Churchill Fellowship FAQ</h1>
<p class="subtitle lead">An introduction for myself and other visitors</p>
  <div class="quarto-categories">
    <div class="quarto-category">Churchill-Fellowship</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Martin Westgate </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 27, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Hello there! Welcome. I’m Martin and this is my first post.</p>
<p>I’ll be using this blog for a few things, but at first, it’ll be a place where I record information related to my Churchill Fellowship. I’ve structured this first post as an FAQ.</p>
<section id="who-are-you" class="level3">
<h3 class="anchored" data-anchor-id="who-are-you">Who are you?</h3>
<p>I run the Science and Decision Support Team at the <a href="https://www.ala.org.au">Atlas of Living Australia</a>, which is hosted by the national science agency (<a href="https://www.csiro.au">CSIRO</a>). The ALA is the Australian node of the Global Biodiversity Information Facility (<a href="https://www.gbif.org">GBIF</a>). My team and I are mostly known for our work in open source software, which you can explore at <a href="https://labs.ala.org.au">ALA labs</a>.</p>
<p>Prior to joining the ALA, I was a researcher in landscape ecology and conservation biology, as part of Professor David Lindenmayer’s lab at the Australian National University.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="science_team_melbs_2025.jpeg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>The ALA Science &amp; Decision Support Team, photographed in 2025. Left to right: Martin Westgate, Shandiya Balasubramaniam, Juliet Seers &amp; Dax Kellie. Amanda Buyan not pictured.</figcaption>
</figure>
</div>
</section>
<section id="what-is-a-churchill-fellowship" class="level3">
<h3 class="anchored" data-anchor-id="what-is-a-churchill-fellowship">What is a Churchill Fellowship?</h3>
<p>The <a href="https://www.churchilltrust.com.au">Churchill Trust</a> is a not-for-profit charitable trust that allocates approximately 100 fellowships each year. It is paid for from the returns of the <a href="https://www.churchilltrust.com.au/about/">largest door-knocking campaign in Australian history</a>, which was held to raise funds in memory of Winston Churchill.</p>
<p>In terms of what a Churchill Fellow <em>does</em>, their <a href="https://www.churchilltrust.com.au/become-a-fellow/">website</a> states:</p>
<blockquote class="blockquote">
<p>A Churchill Fellowship offers Australian citizens and permanent residents a life-changing opportunity to travel overseas.</p>
<p>You don’t need an academic qualification to apply, in fact you don’t need to have completed school. You can do a Churchill Fellowship on any topic, provided there is a benefit to Australia and your community by you sharing your knowledge or skills.</p>
</blockquote>
<p>A Churchill Fellow travels for a short period of time (up to 8 weeks) to learn from International experts in their chosen field, with the goal of returning that information to Australia for the national benefit.</p>
</section>
<section id="what-problem-are-you-trying-to-solve" class="level3">
<h3 class="anchored" data-anchor-id="what-problem-are-you-trying-to-solve">What problem are you trying to solve?</h3>
<p>The ALA aggregates millions of ‘occurrences’, which are observations of plants or animals taken at a particular place and time. These occurrences are provided by hundreds of different institutions, representing thousands of individual observers. Our job is to store and share these observations with the public.</p>
<p>Every year, we run a survey to ask our users how satisfied they are with the ALA. The biggest problem raised by those users is that our data ‘quality’ is inadequate for their needs. While most records from most providers are accurate, there is always a certain proportion of biodiversity observations that are wrong in some way. Unfortunately, as the number of observations increases, even a small error rate translates to many, many incorrect records.</p>
<p>My project is <a href="https://www.churchilltrust.com.au/project/to-investigate-global-scale-solutions-in-biodiversity-informatics/">“To investigate global-scale solutions in biodiversity informatics”</a>, which basically means to find ways to flag potentially erroneous occurrence records.</p>
</section>
<section id="arent-there-already-tools-to-detect-problematic-occurrences" class="level3">
<h3 class="anchored" data-anchor-id="arent-there-already-tools-to-detect-problematic-occurrences">Aren’t there already tools to detect problematic occurrences?</h3>
<p>Yes. Currently, the data quality system at ALA and GBIF involves flagging records with known problems, and allowing the user to make up their own mind as to which problems are in conflict with their needs. This approach has several advantages:</p>
<ul>
<li>It is <strong>reproducible</strong>: rulesets are easy to define, and behave the same way each time.</li>
<li>It <strong>empowers</strong> users: individuals can make their own choices about what ‘quality’ means to them.</li>
<li>It <strong>scales</strong> well: codebases are easy to build, test and maintain.</li>
</ul>
<p>This method also has drawbacks, however. It requires users to understand quite deeply what those checks are and how they work before making a decision. That requires a lot of documentation, which is cumbersome both for maintainers and users. The main problem, though, is that this approach is entirely deterministic; there is no estimate of likelihood or uncertainty.</p>
</section>
<section id="why-have-you-chosen-to-explore-statistical-modelling" class="level3">
<h3 class="anchored" data-anchor-id="why-have-you-chosen-to-explore-statistical-modelling">Why have you chosen to explore statistical modelling?</h3>
<p>When we talk about data ‘quality’, we are implicitly making a statement about how trustworthy we think a piece of data is. Such decisions are not binary, but subtle and gradated. Statistical modelling treats this as a probabalistic problem, which is a natural fit for our intuitive perception of what quality <em>means</em>. Statistical approaches to data quality have practical benefits as well:</p>
<ul>
<li>The underlying principles of building models on large datasets are well understood, and once parameterised, can be repeated with limited oversight.</li>
<li>Models can be added to existing data-processsing workflows without large additions, unlike user-driven approaches which require substantial re-design and re-engineering of existing platforms.</li>
<li>Recent improvements in Artificial Intelligence (AI) and Machine Learning (ML) have brought new methods that can be applied to traditional problems, but are not yet being used for this problem (to my knowledge).</li>
</ul>
<p>Just because statistical models have these properties, though, does not mean that any such project is inherently worthwhile, or that we should start work without any consideration of the strengths and weaknesses of our approach. Hence this fellowship.</p>
</section>
<section id="what-will-you-do-during-your-fellowship" class="level3">
<h3 class="anchored" data-anchor-id="what-will-you-do-during-your-fellowship">What will you do during your Fellowship?</h3>
<p>My primary interest is in discussing these ideas with as diverse a group of potential collaborators as possible. Rather than recreate existing research or tooling, it would be ideal to learn and collaborate on what an optimal solution might look like. Further, once a potential solution or set of solutions is identified, it would be inefficient to pursue those alone rather than with the support of that community. I will meet with interested parties at my host institutions, as well as in universities, museums and government in those host cities. I will be visiting the following institutions:</p>
<ul>
<li><a href="https://www.gbif.no">GBIF Norway</a>, Oslo, Norway</li>
<li><a href="https://biodiversitydata.se">Swedish Biodiversity Data Infrastructure</a>, Stockholm, Sweden</li>
<li><a href="https://www.gbif.org">Global Biodiversity Information Facility</a>, Copenhagen, Denmark</li>
<li><a href="https://www.plantentuinmeise.be">Plantentuin Meise</a>, Flanders, Belgium</li>
<li><a href="https://nbnatlas.org">National Biodiversity Network</a>, London, UK</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stockholm_sunset_2018.jpeg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Sunset over Stockholm, 2018</figcaption>
</figure>
</div>
</section>
<section id="what-are-your-questions" class="level3">
<h3 class="anchored" data-anchor-id="what-are-your-questions">What are your questions?</h3>
<p>I will be visiting groups with very different backgrounds, skillsets and insights, so I’m reluctant to be too restrictive. The nature of the discussion will almost certainly vary from place to place, and as I learn more about the topic. In broad terms, though, the following questions are interesting to me:</p>
<ul>
<li><strong>How much of a problem is data quality?</strong>
<ul>
<li>Is it affecting you, your users or stakeholders, and to what extent? Are current methods nearly or completely adequate? Perhaps existing methods are ‘good enough’, in that they don’t greatly affect decisions made from the underlying data, or are there areas of systemic bias?</li>
</ul></li>
<li><strong>What is the status of recent work on this topic?</strong>
<ul>
<li>What activities, bodies of work, or intellectual or computational tools already exist that might help us? How much effort has already been spent on this problem, and would further activities be beneficial or redundant?</li>
</ul></li>
<li><strong>What should a statistical method do to provide value?</strong>
<ul>
<li>i.e.&nbsp;should it identify all kinds of errors, or just those that are currently difficult to spot? Should it focus on rare or common or threatened taxa? Should it account for misidentified observations? What methods have you found promising in the past?</li>
</ul></li>
<li><strong>How might we integrate insights from different disciplines and approaches?</strong>
<ul>
<li>A range of different classes of models have potential relevance, from species distribution models, to phylogenetic models, to machine learning models. What are their respective strengths and weaknesses? Can we integrate different types of learnings in a single model?</li>
</ul></li>
<li><strong>What is the opportunity cost of alternate solutions?</strong>
<ul>
<li>How should this information be made accessible to users? Would it be more beneficial to work with data providers to clean data rather than productionize new models? Or are there cumulative benefits from doing both?</li>
</ul></li>
<li><strong>Who else should I speak to?</strong>
<ul>
<li>What skills and interests are there in your region or networks that could be brought to bear on solving these problems?</li>
</ul></li>
</ul>
</section>
<section id="what-outcomes-are-you-hoping-for" class="level3">
<h3 class="anchored" data-anchor-id="what-outcomes-are-you-hoping-for">What outcomes are you hoping for?</h3>
<p>First, I’d like to expand and contribute to the network of researchers and professionals already working to improve access to biodiversity information around the world. This network - consisting of both formal and informal collaborations - is already doing great things, and I’m keen to play my part.</p>
<p>Second, I’m hoping we can workshop the opportunities and challenges of this approach, and work to indentify common problems and solutions.</p>
<p>Third, I would like to capture the results of these consultations to ensure benefits are maximised. I’m interested in capturing the results in a scientific paper of some kind, in addition to the report I will produce for the Churchill Trust.</p>
<p>Finally, I’d like to identify people who are interested to continue the journey after the fellowship is complete. Building and optimizing tools of this kind is careful work, and benefits will take time to realise.</p>
</section>
<section id="youre-not-visiting-my-institution-city-country---can-i-still-contribute" class="level3">
<h3 class="anchored" data-anchor-id="youre-not-visiting-my-institution-city-country---can-i-still-contribute">You’re not visiting my institution / city / country - can I still contribute?</h3>
<p>Yes! This Fellowship is useful, but it’s not the whole story. Please reach out to me any time if this topic interests you.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/mjwestgate\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>